<!DOCTYPE html> 
<html lang="es">
<head>
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>Motor de Búsqueda</title> 

    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        body{
            min-height:100vh;
            background:
            radial-gradient(circle at 20% 20%, #4c6fb7 0%, transparent 35%),
            radial-gradient(circle at 80% 80%, #1b2d57 0%, transparent 40%),
            linear-gradient(135deg,#3C5B8F,#112250);
            font-family:'Libre Baskerville', serif;
            color:#F5F0E9;
            overflow-x:hidden;
        }


      
        header{
            background:rgba(255,255,255,.35);
            backdrop-filter:blur(20px);
            padding:15px 30px;
            color:#112250;
            font-size:26px;
            font-weight:bold;
            border-bottom:2px solid #E0C58F;
            display:flex;
            justify-content:space-between;
            align-items:center;
            box-shadow:0 0 25px rgba(0,0,0,.25);
        }

        .header-glass{
            position: sticky;
            top: 0;
            z-index: 20;

            margin: 20px;
            padding: 18px 28px;

            display: flex;
            align-items: center;
            gap: 15px;

            background: rgba(255,255,255,0.35);
            backdrop-filter: blur(20px);

            border-radius: 22px;
            border: 2px solid #E0C58F;

            box-shadow: 0 0 30px rgba(0,0,0,.35);
        }
        
        .header-glass img{
            width: 42px;
            height: 42px;
            object-fit: contain;
        }

        .header-glass span{
            font-size: 22px;
            font-weight: 600;
            color: #112250;
            letter-spacing: 4px;
        }

        .logo {
            width: 55px;
            height: 55px;
            object-fit: contain;
        }

        .logo-top{
            position: fixed;
            top: 20px;
            right: 30px;

            display: flex;
            align-items: center;
            gap: 12px;

            color: #F5F0E9;
            font-size: 20px;
            font-weight: 600;
            letter-spacing: 4px;

            text-decoration: none;   /* ← importante */
            cursor: pointer;

            z-index: 20;
        }
        
        .logo-top:hover{
            opacity: 0.85;
        }

        .logo-top img {
            width: 42px;
            height: 42px;
            object-fit: contain;
        }

        .barra_busqueda {
            text-align: center;
            margin: 30px 0;
        }

        .barra_busqueda input {
            width: 90%;
            max-width: 600px;
            padding: 12px;
            font-size: 18px;
            border-radius: 18px;
            border: 2px solid #E0C58F;
            outline: none;
        }

        .barra_busqueda form {
            background:rgba(255,255,255,.35);
            backdrop-filter:blur(20px);
            padding:25px;
            border-radius:30px;
            display:flex;
            flex-wrap:wrap;
            gap:15px;
            justify-content:center;
            box-shadow:0 0 30px rgba(0,0,0,.25);
        }

        .barra_busqueda input,
        .barra_busqueda select {
            padding:12px 16px;
            font-size:16px;
            border-radius:18px;
            border:2px solid #E0C58F;
            outline:none;
        }


        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            padding: 20px 40px;
        }

        .tarjeta {
            background:white;
            border-radius:25px;
            box-shadow:0 12px 25px rgba(0,0,0,.25);
            overflow:hidden;
            transition:.35s;
        }

        .tarjeta:hover {
            transform:translateY(-6px) scale(1.03);
            box-shadow:0 0 30px #E0C58F;
        }

        .tarjeta img {
            width:100%;
            max-height:200px;
            object-fit:cover;
            display:block;
        }

        .tarjeta img:empty {
            display:none;
        }


        .contenido {
            padding: 15px;
        }

        .titulo {
            font-size: 19px;
            font-weight: bold;
            color: #002b5b;
        }

        .categoria, .color {
            font-size: 14px;
            color: #333;
            margin-bottom: 6px;
        }

        .boton {
            display:inline-block;
            background:#E0C58F;
            padding:10px 18px;
            color:#112250;
            text-decoration:none;
            border-radius:14px;
            font-weight:bold;
            transition:.3s;
        }

        .boton:hover {
            background:#112250;
            color:#E0C58F;
        }

        

    </style>
</head>

<body>

<a href="/menu" class="logo-top">
    <img src="{{ url_for('static', filename='img/logo.png') }}" alt="">
    <span>O.R.I.O.</span>
</a>



<h1 style="text-align:center; margin-top:20px; color:#E0C58F;">Motor de búsqueda</h1>

<!-- Contenedor de búsqueda -->
<div class="barra_busqueda">
    <form id="filtroForm">
        <input type="text" id="Motor" placeholder="Buscar objeto..." autocomplete="off">
        <select id="categoria">
            <option value="">Todas las categorías</option>
            <option value="Documentos">Documentos</option>
            <option value="Tecnología">Tecnología</option>
            <option value="Accesorios">Accesorios</option>
            <option value="Ropa">Ropa</option>
            <option value="Llaves">Llaves</option>
            <option value="Otros">Otros</option>
        </select>
        <select id="tipo">
            <option value="">Todos</option>
            <option value="perdido">Perdido</option>
            <option value="encontrado">Encontrado</option>
        </select>
    </form>
</div>

<!-- Contenedor de tarjetas -->
<div class="grid">

</div> 

</body>
<script>

    const motor = document.getElementById("Motor");
    const categoria = document.getElementById("categoria");
    const tipo = document.getElementById("tipo");
    const form = document.getElementById("filtroForm");

    async function buscar(e) {
        if (e) e.preventDefault(); // Evita recarga del form
        const q = motor.value;
        const cat = categoria.value;
        const tip = tipo.value;
        const params = new URLSearchParams({
            q: q,
            categoria: cat,
            tipo: tip
        });
        const res = await fetch(`/busquedas?${params.toString()}`);
        const datos = await res.json();
        const caja = document.querySelector(".grid");
        caja.innerHTML = "";
        if (datos["datos"]) {
            const objetos = datos["datos"];
            objetos.forEach(objeto => {

                let imagen_html = "";
                if (objeto.IMAGEN) {
                    imagen_html = `<img src="${objeto.IMAGEN}" alt="Imagen del objeto">`;
                }

                let html = `<div class="tarjeta" data-id-objeto="${objeto.ID_OBJETO}">
                                ${imagen_html}
                                <div class="contenido">
                                    <div class="titulo">${objeto.NOMBRE}</div>
                                    <div class="categoria">Categoría: ${objeto.ID_CATEGORIA}</div>
                                    <div class="color">Color: ${objeto.COLOR}</div>
                                    <a class="boton" href="/detalles/${objeto.ID_OBJETO}">Ver detalles</a>
                                </div>
                            </div>`;

                caja.insertAdjacentHTML("beforeend", html);
            });

        } else {
            caja.innerHTML = datos["mensaje"];
        }
    }

    // Buscar al escribir, cambiar select o enviar form (Enter)
    motor.addEventListener("input", buscar);
    categoria.addEventListener("change", buscar);
    tipo.addEventListener("change", buscar);
    form.addEventListener("submit", buscar);
    // Ejecutar búsqueda inicial
    buscar();

</script>
</html>